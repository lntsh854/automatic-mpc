#include "C:\Users\Admin\Documents\GitHub\Cpp\Kompilator_skrosny\Libs\C\defines.h"
#include "C:\Users\Admin\Documents\GitHub\Cpp\Kompilator_skrosny\Libs\C\mpctools.h"
#include "C:\Users\Admin\Documents\GitHub\Cpp\Kompilator_skrosny\Libs\C\simulated_signals.h"
#include "C:\Users\Admin\Documents\GitHub\Cpp\Kompilator_skrosny\Libs\C\default_functions.h"
#include "stm32f7xx_hal.h"
#include <string.h>
#include "low_lvl_main.h"
#include "obl_macierzowe.h"
#include "mat_lib.h"
#include "alokacja_nr.h"
#include "pk.h"

#define __FUN_WRITE() {write_string((char*)__func__);write_string((char*)"\r\n");}while(0)

char str[100];
int i = -50;
uint32_t tcur = 0;
uint32_t tmax = 0;
uint32_t tmin = 0xFFFFFFFF;

extern ADC_HandleTypeDef hadc3;
extern DMA_HandleTypeDef hdma_adc3;

extern DAC_HandleTypeDef hdac;

extern TIM_HandleTypeDef htim2;
extern TIM_HandleTypeDef htim5;

extern UART_HandleTypeDef huart1;

extern void timer_loop(void);
void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim){
    if (htim->Instance == TIM2) {
        timer_loop();
    }
}

long get_time(){
    return HAL_GetTick();
}

float* measureOutput(){
    return __measureOutput(); // values from -1 to 1
}

void setControlValue(float* value){ // values from -1 to 1
    __setControlValue(value);
}

void hardware_setup(){
    low_lvl_main();
}

void string_spin(){
    static int ind = 0;
    static char txt[3] = "?\r\0";
    // static char stages[4] = {'\\','|','/','-'}; int ssize = 4;
    static char stages[5] = {' ','_','o','O','o'}; int ssize = 5;
    txt[0] = stages[ind];
    write_string(txt);
    ind = (ind+1)%ssize;
}

void printMat(float ** A, long x, long y, const char * fmat){
    long i = 1;
    long j = 1;
    for(i=1; i<=x; ++i){
        if(i==1) write_string("[");
        else     write_string(" ");
        for(j=1; j<=y; ++j){
            sprintf(str,fmat,A[i][j]);
            write_string(str);
            if(j==y && i!=x) write_string(";\n\r");
            if(j!=y) write_string(",");
        }
        if(i==x) write_string("]\n\r");
    }
}

void printVec(float * A, long x, const char * fmat){
    long i = 1;
    write_string("[");
    for(i=1; i<=x; ++i){
        if(i!=1) write_string(" ");
        sprintf(str,fmat,A[i]);
        write_string(str);
        if(i!=x) write_string(";\n\r");
    }
    write_string("]\n\r");
}
//////////////////////////////////////////////////// TUTAJ ZACZYNA SIE ROBOTA SPECJALISTY MATLAB
void CONTROLLER(ArchiveData * ad, CurrentControl * c){
	static long m,i,j,p,n,l;
	static float ymod,ddmc,liczba;
	static float du[1];
	static float **reg_M,**reg_PSI,**reg_LAMBDA;
	static float **mod_wspa,***mod_wspb,*reg_Yzad,*reg_Y0;
	static float **pk_A,**pk_G,*pk_b,*pk_t,*pk_x,*reg_wp1,**reg_mp1,**reg_gpc_y0;
	const long k = 0;
	if(ad == NULL){
		mod_wspa=dtablica(1,1,1,2);
		mod_wspb=dtablica3(1,1,1,1,1,2);
		reg_M=dtablica(1,20,1,20);
		reg_PSI=dtablica(1,20,1,20);
		reg_LAMBDA=dtablica(1,20,1,20);
		mod_wspa[1][1] = -5.497113812134730e-01f;
		mod_wspa[1][2] = +1.243920748691000e-03f;
		mod_wspb[1][1][1] = +3.804981147318550e-01f;
		mod_wspb[1][1][2] = +5.703691607777100e-02f;
		reg_M[1][1] = +3.804981147318550e-01f;		reg_M[1][2] = +0.000000000000000e+00f;		reg_M[1][3] = +0.000000000000000e+00f;		reg_M[1][4] = +0.000000000000000e+00f;		reg_M[1][5] = +0.000000000000000e+00f;		reg_M[1][6] = +0.000000000000000e+00f;		reg_M[1][7] = +0.000000000000000e+00f;		reg_M[1][8] = +0.000000000000000e+00f;		reg_M[1][9] = +0.000000000000000e+00f;		reg_M[1][10] = +0.000000000000000e+00f;		reg_M[1][11] = +0.000000000000000e+00f;		reg_M[1][12] = +0.000000000000000e+00f;		reg_M[1][13] = +0.000000000000000e+00f;		reg_M[1][14] = +0.000000000000000e+00f;		reg_M[1][15] = +0.000000000000000e+00f;		reg_M[1][16] = +0.000000000000000e+00f;		reg_M[1][17] = +0.000000000000000e+00f;		reg_M[1][18] = +0.000000000000000e+00f;		reg_M[1][19] = +0.000000000000000e+00f;		reg_M[1][20] = +0.000000000000000e+00f;		reg_M[2][1] = +6.466991750079966e-01f;		reg_M[2][2] = +3.804981147318550e-01f;		reg_M[2][3] = +0.000000000000000e+00f;		reg_M[2][4] = +0.000000000000000e+00f;		reg_M[2][5] = +0.000000000000000e+00f;		reg_M[2][6] = +0.000000000000000e+00f;		reg_M[2][7] = +0.000000000000000e+00f;		reg_M[2][8] = +0.000000000000000e+00f;		reg_M[2][9] = +0.000000000000000e+00f;		reg_M[2][10] = +0.000000000000000e+00f;		reg_M[2][11] = +0.000000000000000e+00f;		reg_M[2][12] = +0.000000000000000e+00f;		reg_M[2][13] = +0.000000000000000e+00f;		reg_M[2][14] = +0.000000000000000e+00f;		reg_M[2][15] = +0.000000000000000e+00f;		reg_M[2][16] = +0.000000000000000e+00f;		reg_M[2][17] = +0.000000000000000e+00f;		reg_M[2][18] = +0.000000000000000e+00f;		reg_M[2][19] = +0.000000000000000e+00f;		reg_M[2][20] = +0.000000000000000e+00f;		reg_M[3][1] = +7.925596180331326e-01f;		reg_M[3][2] = +6.466991750079966e-01f;		reg_M[3][3] = +3.804981147318550e-01f;		reg_M[3][4] = +0.000000000000000e+00f;		reg_M[3][5] = +0.000000000000000e+00f;		reg_M[3][6] = +0.000000000000000e+00f;		reg_M[3][7] = +0.000000000000000e+00f;		reg_M[3][8] = +0.000000000000000e+00f;		reg_M[3][9] = +0.000000000000000e+00f;		reg_M[3][10] = +0.000000000000000e+00f;		reg_M[3][11] = +0.000000000000000e+00f;		reg_M[3][12] = +0.000000000000000e+00f;		reg_M[3][13] = +0.000000000000000e+00f;		reg_M[3][14] = +0.000000000000000e+00f;		reg_M[3][15] = +0.000000000000000e+00f;		reg_M[3][16] = +0.000000000000000e+00f;		reg_M[3][17] = +0.000000000000000e+00f;		reg_M[3][18] = +0.000000000000000e+00f;		reg_M[3][19] = +0.000000000000000e+00f;		reg_M[3][20] = +0.000000000000000e+00f;		reg_M[4][1] = +8.724096306106881e-01f;		reg_M[4][2] = +7.925596180331326e-01f;		reg_M[4][3] = +6.466991750079966e-01f;		reg_M[4][4] = +3.804981147318550e-01f;		reg_M[4][5] = +0.000000000000000e+00f;		reg_M[4][6] = +0.000000000000000e+00f;		reg_M[4][7] = +0.000000000000000e+00f;		reg_M[4][8] = +0.000000000000000e+00f;		reg_M[4][9] = +0.000000000000000e+00f;		reg_M[4][10] = +0.000000000000000e+00f;		reg_M[4][11] = +0.000000000000000e+00f;		reg_M[4][12] = +0.000000000000000e+00f;		reg_M[4][13] = +0.000000000000000e+00f;		reg_M[4][14] = +0.000000000000000e+00f;		reg_M[4][15] = +0.000000000000000e+00f;		reg_M[4][16] = +0.000000000000000e+00f;		reg_M[4][17] = +0.000000000000000e+00f;		reg_M[4][18] = +0.000000000000000e+00f;		reg_M[4][19] = +0.000000000000000e+00f;		reg_M[4][20] = +0.000000000000000e+00f;		reg_M[5][1] = +9.161226524831171e-01f;		reg_M[5][2] = +8.724096306106881e-01f;		reg_M[5][3] = +7.925596180331326e-01f;		reg_M[5][4] = +6.466991750079966e-01f;		reg_M[5][5] = +3.804981147318550e-01f;		reg_M[5][6] = +0.000000000000000e+00f;		reg_M[5][7] = +0.000000000000000e+00f;		reg_M[5][8] = +0.000000000000000e+00f;		reg_M[5][9] = +0.000000000000000e+00f;		reg_M[5][10] = +0.000000000000000e+00f;		reg_M[5][11] = +0.000000000000000e+00f;		reg_M[5][12] = +0.000000000000000e+00f;		reg_M[5][13] = +0.000000000000000e+00f;		reg_M[5][14] = +0.000000000000000e+00f;		reg_M[5][15] = +0.000000000000000e+00f;		reg_M[5][16] = +0.000000000000000e+00f;		reg_M[5][17] = +0.000000000000000e+00f;		reg_M[5][18] = +0.000000000000000e+00f;		reg_M[5][19] = +0.000000000000000e+00f;		reg_M[5][20] = +0.000000000000000e+00f;		reg_M[6][1] = +9.400528710261963e-01f;		reg_M[6][2] = +9.161226524831171e-01f;		reg_M[6][3] = +8.724096306106881e-01f;		reg_M[6][4] = +7.925596180331326e-01f;		reg_M[6][5] = +6.466991750079966e-01f;		reg_M[6][6] = +3.804981147318550e-01f;		reg_M[6][7] = +0.000000000000000e+00f;		reg_M[6][8] = +0.000000000000000e+00f;		reg_M[6][9] = +0.000000000000000e+00f;		reg_M[6][10] = +0.000000000000000e+00f;		reg_M[6][11] = +0.000000000000000e+00f;		reg_M[6][12] = +0.000000000000000e+00f;		reg_M[6][13] = +0.000000000000000e+00f;		reg_M[6][14] = +0.000000000000000e+00f;		reg_M[6][15] = +0.000000000000000e+00f;		reg_M[6][16] = +0.000000000000000e+00f;		reg_M[6][17] = +0.000000000000000e+00f;		reg_M[6][18] = +0.000000000000000e+00f;		reg_M[6][19] = +0.000000000000000e+00f;		reg_M[6][20] = +0.000000000000000e+00f;		reg_M[7][1] = +9.531532089793574e-01f;		reg_M[7][2] = +9.400528710261963e-01f;		reg_M[7][3] = +9.161226524831171e-01f;		reg_M[7][4] = +8.724096306106881e-01f;		reg_M[7][5] = +7.925596180331326e-01f;		reg_M[7][6] = +6.466991750079966e-01f;		reg_M[7][7] = +3.804981147318550e-01f;		reg_M[7][8] = +0.000000000000000e+00f;		reg_M[7][9] = +0.000000000000000e+00f;		reg_M[7][10] = +0.000000000000000e+00f;		reg_M[7][11] = +0.000000000000000e+00f;		reg_M[7][12] = +0.000000000000000e+00f;		reg_M[7][13] = +0.000000000000000e+00f;		reg_M[7][14] = +0.000000000000000e+00f;		reg_M[7][15] = +0.000000000000000e+00f;		reg_M[7][16] = +0.000000000000000e+00f;		reg_M[7][17] = +0.000000000000000e+00f;		reg_M[7][18] = +0.000000000000000e+00f;		reg_M[7][19] = +0.000000000000000e+00f;		reg_M[7][20] = +0.000000000000000e+00f;		reg_M[8][1] = +9.603248465545865e-01f;		reg_M[8][2] = +9.531532089793574e-01f;		reg_M[8][3] = +9.400528710261963e-01f;		reg_M[8][4] = +9.161226524831171e-01f;		reg_M[8][5] = +8.724096306106881e-01f;		reg_M[8][6] = +7.925596180331326e-01f;		reg_M[8][7] = +6.466991750079966e-01f;		reg_M[8][8] = +3.804981147318550e-01f;		reg_M[8][9] = +0.000000000000000e+00f;		reg_M[8][10] = +0.000000000000000e+00f;		reg_M[8][11] = +0.000000000000000e+00f;		reg_M[8][12] = +0.000000000000000e+00f;		reg_M[8][13] = +0.000000000000000e+00f;		reg_M[8][14] = +0.000000000000000e+00f;		reg_M[8][15] = +0.000000000000000e+00f;		reg_M[8][16] = +0.000000000000000e+00f;		reg_M[8][17] = +0.000000000000000e+00f;		reg_M[8][18] = +0.000000000000000e+00f;		reg_M[8][19] = +0.000000000000000e+00f;		reg_M[8][20] = +0.000000000000000e+00f;		reg_M[9][1] = +9.642508815694334e-01f;		reg_M[9][2] = +9.603248465545865e-01f;		reg_M[9][3] = +9.531532089793574e-01f;		reg_M[9][4] = +9.400528710261963e-01f;		reg_M[9][5] = +9.161226524831171e-01f;		reg_M[9][6] = +8.724096306106881e-01f;		reg_M[9][7] = +7.925596180331326e-01f;		reg_M[9][8] = +6.466991750079966e-01f;		reg_M[9][9] = +3.804981147318550e-01f;		reg_M[9][10] = +0.000000000000000e+00f;		reg_M[9][11] = +0.000000000000000e+00f;		reg_M[9][12] = +0.000000000000000e+00f;		reg_M[9][13] = +0.000000000000000e+00f;		reg_M[9][14] = +0.000000000000000e+00f;		reg_M[9][15] = +0.000000000000000e+00f;		reg_M[9][16] = +0.000000000000000e+00f;		reg_M[9][17] = +0.000000000000000e+00f;		reg_M[9][18] = +0.000000000000000e+00f;		reg_M[9][19] = +0.000000000000000e+00f;		reg_M[9][20] = +0.000000000000000e+00f;		reg_M[10][1] = +9.664001467513556e-01f;		reg_M[10][2] = +9.642508815694334e-01f;		reg_M[10][3] = +9.603248465545865e-01f;		reg_M[10][4] = +9.531532089793574e-01f;		reg_M[10][5] = +9.400528710261963e-01f;		reg_M[10][6] = +9.161226524831171e-01f;		reg_M[10][7] = +8.724096306106881e-01f;		reg_M[10][8] = +7.925596180331326e-01f;		reg_M[10][9] = +6.466991750079966e-01f;		reg_M[10][10] = +3.804981147318550e-01f;		reg_M[10][11] = +0.000000000000000e+00f;		reg_M[10][12] = +0.000000000000000e+00f;		reg_M[10][13] = +0.000000000000000e+00f;		reg_M[10][14] = +0.000000000000000e+00f;		reg_M[10][15] = +0.000000000000000e+00f;		reg_M[10][16] = +0.000000000000000e+00f;		reg_M[10][17] = +0.000000000000000e+00f;		reg_M[10][18] = +0.000000000000000e+00f;		reg_M[10][19] = +0.000000000000000e+00f;		reg_M[10][20] = +0.000000000000000e+00f;		reg_M[11][1] = +9.675767386066888e-01f;		reg_M[11][2] = +9.664001467513556e-01f;		reg_M[11][3] = +9.642508815694334e-01f;		reg_M[11][4] = +9.603248465545865e-01f;		reg_M[11][5] = +9.531532089793574e-01f;		reg_M[11][6] = +9.400528710261963e-01f;		reg_M[11][7] = +9.161226524831171e-01f;		reg_M[11][8] = +8.724096306106881e-01f;		reg_M[11][9] = +7.925596180331326e-01f;		reg_M[11][10] = +6.466991750079966e-01f;		reg_M[11][11] = +3.804981147318550e-01f;		reg_M[11][12] = +0.000000000000000e+00f;		reg_M[11][13] = +0.000000000000000e+00f;		reg_M[11][14] = +0.000000000000000e+00f;		reg_M[11][15] = +0.000000000000000e+00f;		reg_M[11][16] = +0.000000000000000e+00f;		reg_M[11][17] = +0.000000000000000e+00f;		reg_M[11][18] = +0.000000000000000e+00f;		reg_M[11][19] = +0.000000000000000e+00f;		reg_M[11][20] = +0.000000000000000e+00f;		reg_M[12][1] = +9.682208510250544e-01f;		reg_M[12][2] = +9.675767386066888e-01f;		reg_M[12][3] = +9.664001467513556e-01f;		reg_M[12][4] = +9.642508815694334e-01f;		reg_M[12][5] = +9.603248465545865e-01f;		reg_M[12][6] = +9.531532089793574e-01f;		reg_M[12][7] = +9.400528710261963e-01f;		reg_M[12][8] = +9.161226524831171e-01f;		reg_M[12][9] = +8.724096306106881e-01f;		reg_M[12][10] = +7.925596180331326e-01f;		reg_M[12][11] = +6.466991750079966e-01f;		reg_M[12][12] = +3.804981147318550e-01f;		reg_M[12][13] = +0.000000000000000e+00f;		reg_M[12][14] = +0.000000000000000e+00f;		reg_M[12][15] = +0.000000000000000e+00f;		reg_M[12][16] = +0.000000000000000e+00f;		reg_M[12][17] = +0.000000000000000e+00f;		reg_M[12][18] = +0.000000000000000e+00f;		reg_M[12][19] = +0.000000000000000e+00f;		reg_M[12][20] = +0.000000000000000e+00f;		reg_M[13][1] = +9.685734633651894e-01f;		reg_M[13][2] = +9.682208510250544e-01f;		reg_M[13][3] = +9.675767386066888e-01f;		reg_M[13][4] = +9.664001467513556e-01f;		reg_M[13][5] = +9.642508815694334e-01f;		reg_M[13][6] = +9.603248465545865e-01f;		reg_M[13][7] = +9.531532089793574e-01f;		reg_M[13][8] = +9.400528710261963e-01f;		reg_M[13][9] = +9.161226524831171e-01f;		reg_M[13][10] = +8.724096306106881e-01f;		reg_M[13][11] = +7.925596180331326e-01f;		reg_M[13][12] = +6.466991750079966e-01f;		reg_M[13][13] = +3.804981147318550e-01f;		reg_M[13][14] = +0.000000000000000e+00f;		reg_M[13][15] = +0.000000000000000e+00f;		reg_M[13][16] = +0.000000000000000e+00f;		reg_M[13][17] = +0.000000000000000e+00f;		reg_M[13][18] = +0.000000000000000e+00f;		reg_M[13][19] = +0.000000000000000e+00f;		reg_M[13][20] = +0.000000000000000e+00f;		reg_M[14][1] = +9.687664971569161e-01f;		reg_M[14][2] = +9.685734633651894e-01f;		reg_M[14][3] = +9.682208510250544e-01f;		reg_M[14][4] = +9.675767386066888e-01f;		reg_M[14][5] = +9.664001467513556e-01f;		reg_M[14][6] = +9.642508815694334e-01f;		reg_M[14][7] = +9.603248465545865e-01f;		reg_M[14][8] = +9.531532089793574e-01f;		reg_M[14][9] = +9.400528710261963e-01f;		reg_M[14][10] = +9.161226524831171e-01f;		reg_M[14][11] = +8.724096306106881e-01f;		reg_M[14][12] = +7.925596180331326e-01f;		reg_M[14][13] = +6.466991750079966e-01f;		reg_M[14][14] = +3.804981147318550e-01f;		reg_M[14][15] = +0.000000000000000e+00f;		reg_M[14][16] = +0.000000000000000e+00f;		reg_M[14][17] = +0.000000000000000e+00f;		reg_M[14][18] = +0.000000000000000e+00f;		reg_M[14][19] = +0.000000000000000e+00f;		reg_M[14][20] = +0.000000000000000e+00f;		reg_M[15][1] = +9.688721714073810e-01f;		reg_M[15][2] = +9.687664971569161e-01f;		reg_M[15][3] = +9.685734633651894e-01f;		reg_M[15][4] = +9.682208510250544e-01f;		reg_M[15][5] = +9.675767386066888e-01f;		reg_M[15][6] = +9.664001467513556e-01f;		reg_M[15][7] = +9.642508815694334e-01f;		reg_M[15][8] = +9.603248465545865e-01f;		reg_M[15][9] = +9.531532089793574e-01f;		reg_M[15][10] = +9.400528710261963e-01f;		reg_M[15][11] = +9.161226524831171e-01f;		reg_M[15][12] = +8.724096306106881e-01f;		reg_M[15][13] = +7.925596180331326e-01f;		reg_M[15][14] = +6.466991750079966e-01f;		reg_M[15][15] = +3.804981147318550e-01f;		reg_M[15][16] = +0.000000000000000e+00f;		reg_M[15][17] = +0.000000000000000e+00f;		reg_M[15][18] = +0.000000000000000e+00f;		reg_M[15][19] = +0.000000000000000e+00f;		reg_M[15][20] = +0.000000000000000e+00f;		reg_M[16][1] = +9.689300216268240e-01f;		reg_M[16][2] = +9.688721714073810e-01f;		reg_M[16][3] = +9.687664971569161e-01f;		reg_M[16][4] = +9.685734633651894e-01f;		reg_M[16][5] = +9.682208510250544e-01f;		reg_M[16][6] = +9.675767386066888e-01f;		reg_M[16][7] = +9.664001467513556e-01f;		reg_M[16][8] = +9.642508815694334e-01f;		reg_M[16][9] = +9.603248465545865e-01f;		reg_M[16][10] = +9.531532089793574e-01f;		reg_M[16][11] = +9.400528710261963e-01f;		reg_M[16][12] = +9.161226524831171e-01f;		reg_M[16][13] = +8.724096306106881e-01f;		reg_M[16][14] = +7.925596180331326e-01f;		reg_M[16][15] = +6.466991750079966e-01f;		reg_M[16][16] = +3.804981147318550e-01f;		reg_M[16][17] = +0.000000000000000e+00f;		reg_M[16][18] = +0.000000000000000e+00f;		reg_M[16][19] = +0.000000000000000e+00f;		reg_M[16][20] = +0.000000000000000e+00f;		reg_M[17][1] = +9.689616911004647e-01f;		reg_M[17][2] = +9.689300216268240e-01f;		reg_M[17][3] = +9.688721714073810e-01f;		reg_M[17][4] = +9.687664971569161e-01f;		reg_M[17][5] = +9.685734633651894e-01f;		reg_M[17][6] = +9.682208510250544e-01f;		reg_M[17][7] = +9.675767386066888e-01f;		reg_M[17][8] = +9.664001467513556e-01f;		reg_M[17][9] = +9.642508815694334e-01f;		reg_M[17][10] = +9.603248465545865e-01f;		reg_M[17][11] = +9.531532089793574e-01f;		reg_M[17][12] = +9.400528710261963e-01f;		reg_M[17][13] = +9.161226524831171e-01f;		reg_M[17][14] = +8.724096306106881e-01f;		reg_M[17][15] = +7.925596180331326e-01f;		reg_M[17][16] = +6.466991750079966e-01f;		reg_M[17][17] = +3.804981147318550e-01f;		reg_M[17][18] = +0.000000000000000e+00f;		reg_M[17][19] = +0.000000000000000e+00f;		reg_M[17][20] = +0.000000000000000e+00f;		reg_M[18][1] = +9.689790282094739e-01f;		reg_M[18][2] = +9.689616911004647e-01f;		reg_M[18][3] = +9.689300216268240e-01f;		reg_M[18][4] = +9.688721714073810e-01f;		reg_M[18][5] = +9.687664971569161e-01f;		reg_M[18][6] = +9.685734633651894e-01f;		reg_M[18][7] = +9.682208510250544e-01f;		reg_M[18][8] = +9.675767386066888e-01f;		reg_M[18][9] = +9.664001467513556e-01f;		reg_M[18][10] = +9.642508815694334e-01f;		reg_M[18][11] = +9.603248465545865e-01f;		reg_M[18][12] = +9.531532089793574e-01f;		reg_M[18][13] = +9.400528710261963e-01f;		reg_M[18][14] = +9.161226524831171e-01f;		reg_M[18][15] = +8.724096306106881e-01f;		reg_M[18][16] = +7.925596180331326e-01f;		reg_M[18][17] = +6.466991750079966e-01f;		reg_M[18][18] = +3.804981147318550e-01f;		reg_M[18][19] = +0.000000000000000e+00f;		reg_M[18][20] = +0.000000000000000e+00f;		reg_M[19][1] = +9.689885192212981e-01f;		reg_M[19][2] = +9.689790282094739e-01f;		reg_M[19][3] = +9.689616911004647e-01f;		reg_M[19][4] = +9.689300216268240e-01f;		reg_M[19][5] = +9.688721714073810e-01f;		reg_M[19][6] = +9.687664971569161e-01f;		reg_M[19][7] = +9.685734633651894e-01f;		reg_M[19][8] = +9.682208510250544e-01f;		reg_M[19][9] = +9.675767386066888e-01f;		reg_M[19][10] = +9.664001467513556e-01f;		reg_M[19][11] = +9.642508815694334e-01f;		reg_M[19][12] = +9.603248465545865e-01f;		reg_M[19][13] = +9.531532089793574e-01f;		reg_M[19][14] = +9.400528710261963e-01f;		reg_M[19][15] = +9.161226524831171e-01f;		reg_M[19][16] = +8.724096306106881e-01f;		reg_M[19][17] = +7.925596180331326e-01f;		reg_M[19][18] = +6.466991750079966e-01f;		reg_M[19][19] = +3.804981147318550e-01f;		reg_M[19][20] = +0.000000000000000e+00f;		reg_M[20][1] = +9.689937149725274e-01f;		reg_M[20][2] = +9.689885192212981e-01f;		reg_M[20][3] = +9.689790282094739e-01f;		reg_M[20][4] = +9.689616911004647e-01f;		reg_M[20][5] = +9.689300216268240e-01f;		reg_M[20][6] = +9.688721714073810e-01f;		reg_M[20][7] = +9.687664971569161e-01f;		reg_M[20][8] = +9.685734633651894e-01f;		reg_M[20][9] = +9.682208510250544e-01f;		reg_M[20][10] = +9.675767386066888e-01f;		reg_M[20][11] = +9.664001467513556e-01f;		reg_M[20][12] = +9.642508815694334e-01f;		reg_M[20][13] = +9.603248465545865e-01f;		reg_M[20][14] = +9.531532089793574e-01f;		reg_M[20][15] = +9.400528710261963e-01f;		reg_M[20][16] = +9.161226524831171e-01f;		reg_M[20][17] = +8.724096306106881e-01f;		reg_M[20][18] = +7.925596180331326e-01f;		reg_M[20][19] = +6.466991750079966e-01f;		reg_M[20][20] = +3.804981147318550e-01f;
		for(i=1;i<=20;++i)
			for(j=1;j<=20;++j)
				reg_PSI[i][j] = 0.0f;
		reg_PSI[1][1] = +1.000000000000000e+00f;
		reg_PSI[2][2] = +1.000000000000000e+00f;
		reg_PSI[3][3] = +1.000000000000000e+00f;
		reg_PSI[4][4] = +1.000000000000000e+00f;
		reg_PSI[5][5] = +1.000000000000000e+00f;
		reg_PSI[6][6] = +1.000000000000000e+00f;
		reg_PSI[7][7] = +1.000000000000000e+00f;
		reg_PSI[8][8] = +1.000000000000000e+00f;
		reg_PSI[9][9] = +1.000000000000000e+00f;
		reg_PSI[10][10] = +1.000000000000000e+00f;
		reg_PSI[11][11] = +1.000000000000000e+00f;
		reg_PSI[12][12] = +1.000000000000000e+00f;
		reg_PSI[13][13] = +1.000000000000000e+00f;
		reg_PSI[14][14] = +1.000000000000000e+00f;
		reg_PSI[15][15] = +1.000000000000000e+00f;
		reg_PSI[16][16] = +1.000000000000000e+00f;
		reg_PSI[17][17] = +1.000000000000000e+00f;
		reg_PSI[18][18] = +1.000000000000000e+00f;
		reg_PSI[19][19] = +1.000000000000000e+00f;
		reg_PSI[20][20] = +1.000000000000000e+00f;

		for(i=1;i<=20;++i)
			for(j=1;j<=20;++j)
				reg_LAMBDA[i][j] = 0.0f;
		reg_LAMBDA[1][1] = +1.000000000000000e+00f;
		reg_LAMBDA[2][2] = +1.000000000000000e+00f;
		reg_LAMBDA[3][3] = +1.000000000000000e+00f;
		reg_LAMBDA[4][4] = +1.000000000000000e+00f;
		reg_LAMBDA[5][5] = +1.000000000000000e+00f;
		reg_LAMBDA[6][6] = +1.000000000000000e+00f;
		reg_LAMBDA[7][7] = +1.000000000000000e+00f;
		reg_LAMBDA[8][8] = +1.000000000000000e+00f;
		reg_LAMBDA[9][9] = +1.000000000000000e+00f;
		reg_LAMBDA[10][10] = +1.000000000000000e+00f;
		reg_LAMBDA[11][11] = +1.000000000000000e+00f;
		reg_LAMBDA[12][12] = +1.000000000000000e+00f;
		reg_LAMBDA[13][13] = +1.000000000000000e+00f;
		reg_LAMBDA[14][14] = +1.000000000000000e+00f;
		reg_LAMBDA[15][15] = +1.000000000000000e+00f;
		reg_LAMBDA[16][16] = +1.000000000000000e+00f;
		reg_LAMBDA[17][17] = +1.000000000000000e+00f;
		reg_LAMBDA[18][18] = +1.000000000000000e+00f;
		reg_LAMBDA[19][19] = +1.000000000000000e+00f;
		reg_LAMBDA[20][20] = +1.000000000000000e+00f;

		ustawilogr(80);
		ustawilzm(20);

		inicjalizacjapk();
		pk_A=pobierzA();
		pk_G=pobierzG();
		pk_b=pobierzb();
		pk_t=pobierzt();
		pk_x=pobierzx();

		for(i=1;i<=80;++i)
			for(j=1;j<=20;++j)
				pk_A[i][j] = 0.0f;
		pk_A[1][1] = +1.000000000000000e+00f;
		pk_A[2][1] = -1.000000000000000e+00f;
		pk_A[3][1] = +1.000000000000000e+00f;
		pk_A[3][2] = +1.000000000000000e+00f;
		pk_A[4][1] = -1.000000000000000e+00f;
		pk_A[4][2] = -1.000000000000000e+00f;
		pk_A[5][1] = +1.000000000000000e+00f;
		pk_A[5][2] = +1.000000000000000e+00f;
		pk_A[5][3] = +1.000000000000000e+00f;
		pk_A[6][1] = -1.000000000000000e+00f;
		pk_A[6][2] = -1.000000000000000e+00f;
		pk_A[6][3] = -1.000000000000000e+00f;
		pk_A[7][1] = +1.000000000000000e+00f;
		pk_A[7][2] = +1.000000000000000e+00f;
		pk_A[7][3] = +1.000000000000000e+00f;
		pk_A[7][4] = +1.000000000000000e+00f;
		pk_A[8][1] = -1.000000000000000e+00f;
		pk_A[8][2] = -1.000000000000000e+00f;
		pk_A[8][3] = -1.000000000000000e+00f;
		pk_A[8][4] = -1.000000000000000e+00f;
		pk_A[9][1] = +1.000000000000000e+00f;
		pk_A[9][2] = +1.000000000000000e+00f;
		pk_A[9][3] = +1.000000000000000e+00f;
		pk_A[9][4] = +1.000000000000000e+00f;
		pk_A[9][5] = +1.000000000000000e+00f;
		pk_A[10][1] = -1.000000000000000e+00f;
		pk_A[10][2] = -1.000000000000000e+00f;
		pk_A[10][3] = -1.000000000000000e+00f;
		pk_A[10][4] = -1.000000000000000e+00f;
		pk_A[10][5] = -1.000000000000000e+00f;
		pk_A[11][1] = +1.000000000000000e+00f;
		pk_A[11][2] = +1.000000000000000e+00f;
		pk_A[11][3] = +1.000000000000000e+00f;
		pk_A[11][4] = +1.000000000000000e+00f;
		pk_A[11][5] = +1.000000000000000e+00f;
		pk_A[11][6] = +1.000000000000000e+00f;
		pk_A[12][1] = -1.000000000000000e+00f;
		pk_A[12][2] = -1.000000000000000e+00f;
		pk_A[12][3] = -1.000000000000000e+00f;
		pk_A[12][4] = -1.000000000000000e+00f;
		pk_A[12][5] = -1.000000000000000e+00f;
		pk_A[12][6] = -1.000000000000000e+00f;
		pk_A[13][1] = +1.000000000000000e+00f;
		pk_A[13][2] = +1.000000000000000e+00f;
		pk_A[13][3] = +1.000000000000000e+00f;
		pk_A[13][4] = +1.000000000000000e+00f;
		pk_A[13][5] = +1.000000000000000e+00f;
		pk_A[13][6] = +1.000000000000000e+00f;
		pk_A[13][7] = +1.000000000000000e+00f;
		pk_A[14][1] = -1.000000000000000e+00f;
		pk_A[14][2] = -1.000000000000000e+00f;
		pk_A[14][3] = -1.000000000000000e+00f;
		pk_A[14][4] = -1.000000000000000e+00f;
		pk_A[14][5] = -1.000000000000000e+00f;
		pk_A[14][6] = -1.000000000000000e+00f;
		pk_A[14][7] = -1.000000000000000e+00f;
		pk_A[15][1] = +1.000000000000000e+00f;
		pk_A[15][2] = +1.000000000000000e+00f;
		pk_A[15][3] = +1.000000000000000e+00f;
		pk_A[15][4] = +1.000000000000000e+00f;
		pk_A[15][5] = +1.000000000000000e+00f;
		pk_A[15][6] = +1.000000000000000e+00f;
		pk_A[15][7] = +1.000000000000000e+00f;
		pk_A[15][8] = +1.000000000000000e+00f;
		pk_A[16][1] = -1.000000000000000e+00f;
		pk_A[16][2] = -1.000000000000000e+00f;
		pk_A[16][3] = -1.000000000000000e+00f;
		pk_A[16][4] = -1.000000000000000e+00f;
		pk_A[16][5] = -1.000000000000000e+00f;
		pk_A[16][6] = -1.000000000000000e+00f;
		pk_A[16][7] = -1.000000000000000e+00f;
		pk_A[16][8] = -1.000000000000000e+00f;
		pk_A[17][1] = +1.000000000000000e+00f;
		pk_A[17][2] = +1.000000000000000e+00f;
		pk_A[17][3] = +1.000000000000000e+00f;
		pk_A[17][4] = +1.000000000000000e+00f;
		pk_A[17][5] = +1.000000000000000e+00f;
		pk_A[17][6] = +1.000000000000000e+00f;
		pk_A[17][7] = +1.000000000000000e+00f;
		pk_A[17][8] = +1.000000000000000e+00f;
		pk_A[17][9] = +1.000000000000000e+00f;
		pk_A[18][1] = -1.000000000000000e+00f;
		pk_A[18][2] = -1.000000000000000e+00f;
		pk_A[18][3] = -1.000000000000000e+00f;
		pk_A[18][4] = -1.000000000000000e+00f;
		pk_A[18][5] = -1.000000000000000e+00f;
		pk_A[18][6] = -1.000000000000000e+00f;
		pk_A[18][7] = -1.000000000000000e+00f;
		pk_A[18][8] = -1.000000000000000e+00f;
		pk_A[18][9] = -1.000000000000000e+00f;
		pk_A[19][1] = +1.000000000000000e+00f;
		pk_A[19][2] = +1.000000000000000e+00f;
		pk_A[19][3] = +1.000000000000000e+00f;
		pk_A[19][4] = +1.000000000000000e+00f;
		pk_A[19][5] = +1.000000000000000e+00f;
		pk_A[19][6] = +1.000000000000000e+00f;
		pk_A[19][7] = +1.000000000000000e+00f;
		pk_A[19][8] = +1.000000000000000e+00f;
		pk_A[19][9] = +1.000000000000000e+00f;
		pk_A[19][10] = +1.000000000000000e+00f;
		pk_A[20][1] = -1.000000000000000e+00f;
		pk_A[20][2] = -1.000000000000000e+00f;
		pk_A[20][3] = -1.000000000000000e+00f;
		pk_A[20][4] = -1.000000000000000e+00f;
		pk_A[20][5] = -1.000000000000000e+00f;
		pk_A[20][6] = -1.000000000000000e+00f;
		pk_A[20][7] = -1.000000000000000e+00f;
		pk_A[20][8] = -1.000000000000000e+00f;
		pk_A[20][9] = -1.000000000000000e+00f;
		pk_A[20][10] = -1.000000000000000e+00f;
		pk_A[21][1] = +1.000000000000000e+00f;
		pk_A[21][2] = +1.000000000000000e+00f;
		pk_A[21][3] = +1.000000000000000e+00f;
		pk_A[21][4] = +1.000000000000000e+00f;
		pk_A[21][5] = +1.000000000000000e+00f;
		pk_A[21][6] = +1.000000000000000e+00f;
		pk_A[21][7] = +1.000000000000000e+00f;
		pk_A[21][8] = +1.000000000000000e+00f;
		pk_A[21][9] = +1.000000000000000e+00f;
		pk_A[21][10] = +1.000000000000000e+00f;
		pk_A[21][11] = +1.000000000000000e+00f;
		pk_A[22][1] = -1.000000000000000e+00f;
		pk_A[22][2] = -1.000000000000000e+00f;
		pk_A[22][3] = -1.000000000000000e+00f;
		pk_A[22][4] = -1.000000000000000e+00f;
		pk_A[22][5] = -1.000000000000000e+00f;
		pk_A[22][6] = -1.000000000000000e+00f;
		pk_A[22][7] = -1.000000000000000e+00f;
		pk_A[22][8] = -1.000000000000000e+00f;
		pk_A[22][9] = -1.000000000000000e+00f;
		pk_A[22][10] = -1.000000000000000e+00f;
		pk_A[22][11] = -1.000000000000000e+00f;
		pk_A[23][1] = +1.000000000000000e+00f;
		pk_A[23][2] = +1.000000000000000e+00f;
		pk_A[23][3] = +1.000000000000000e+00f;
		pk_A[23][4] = +1.000000000000000e+00f;
		pk_A[23][5] = +1.000000000000000e+00f;
		pk_A[23][6] = +1.000000000000000e+00f;
		pk_A[23][7] = +1.000000000000000e+00f;
		pk_A[23][8] = +1.000000000000000e+00f;
		pk_A[23][9] = +1.000000000000000e+00f;
		pk_A[23][10] = +1.000000000000000e+00f;
		pk_A[23][11] = +1.000000000000000e+00f;
		pk_A[23][12] = +1.000000000000000e+00f;
		pk_A[24][1] = -1.000000000000000e+00f;
		pk_A[24][2] = -1.000000000000000e+00f;
		pk_A[24][3] = -1.000000000000000e+00f;
		pk_A[24][4] = -1.000000000000000e+00f;
		pk_A[24][5] = -1.000000000000000e+00f;
		pk_A[24][6] = -1.000000000000000e+00f;
		pk_A[24][7] = -1.000000000000000e+00f;
		pk_A[24][8] = -1.000000000000000e+00f;
		pk_A[24][9] = -1.000000000000000e+00f;
		pk_A[24][10] = -1.000000000000000e+00f;
		pk_A[24][11] = -1.000000000000000e+00f;
		pk_A[24][12] = -1.000000000000000e+00f;
		pk_A[25][1] = +1.000000000000000e+00f;
		pk_A[25][2] = +1.000000000000000e+00f;
		pk_A[25][3] = +1.000000000000000e+00f;
		pk_A[25][4] = +1.000000000000000e+00f;
		pk_A[25][5] = +1.000000000000000e+00f;
		pk_A[25][6] = +1.000000000000000e+00f;
		pk_A[25][7] = +1.000000000000000e+00f;
		pk_A[25][8] = +1.000000000000000e+00f;
		pk_A[25][9] = +1.000000000000000e+00f;
		pk_A[25][10] = +1.000000000000000e+00f;
		pk_A[25][11] = +1.000000000000000e+00f;
		pk_A[25][12] = +1.000000000000000e+00f;
		pk_A[25][13] = +1.000000000000000e+00f;
		pk_A[26][1] = -1.000000000000000e+00f;
		pk_A[26][2] = -1.000000000000000e+00f;
		pk_A[26][3] = -1.000000000000000e+00f;
		pk_A[26][4] = -1.000000000000000e+00f;
		pk_A[26][5] = -1.000000000000000e+00f;
		pk_A[26][6] = -1.000000000000000e+00f;
		pk_A[26][7] = -1.000000000000000e+00f;
		pk_A[26][8] = -1.000000000000000e+00f;
		pk_A[26][9] = -1.000000000000000e+00f;
		pk_A[26][10] = -1.000000000000000e+00f;
		pk_A[26][11] = -1.000000000000000e+00f;
		pk_A[26][12] = -1.000000000000000e+00f;
		pk_A[26][13] = -1.000000000000000e+00f;
		pk_A[27][1] = +1.000000000000000e+00f;
		pk_A[27][2] = +1.000000000000000e+00f;
		pk_A[27][3] = +1.000000000000000e+00f;
		pk_A[27][4] = +1.000000000000000e+00f;
		pk_A[27][5] = +1.000000000000000e+00f;
		pk_A[27][6] = +1.000000000000000e+00f;
		pk_A[27][7] = +1.000000000000000e+00f;
		pk_A[27][8] = +1.000000000000000e+00f;
		pk_A[27][9] = +1.000000000000000e+00f;
		pk_A[27][10] = +1.000000000000000e+00f;
		pk_A[27][11] = +1.000000000000000e+00f;
		pk_A[27][12] = +1.000000000000000e+00f;
		pk_A[27][13] = +1.000000000000000e+00f;
		pk_A[27][14] = +1.000000000000000e+00f;
		pk_A[28][1] = -1.000000000000000e+00f;
		pk_A[28][2] = -1.000000000000000e+00f;
		pk_A[28][3] = -1.000000000000000e+00f;
		pk_A[28][4] = -1.000000000000000e+00f;
		pk_A[28][5] = -1.000000000000000e+00f;
		pk_A[28][6] = -1.000000000000000e+00f;
		pk_A[28][7] = -1.000000000000000e+00f;
		pk_A[28][8] = -1.000000000000000e+00f;
		pk_A[28][9] = -1.000000000000000e+00f;
		pk_A[28][10] = -1.000000000000000e+00f;
		pk_A[28][11] = -1.000000000000000e+00f;
		pk_A[28][12] = -1.000000000000000e+00f;
		pk_A[28][13] = -1.000000000000000e+00f;
		pk_A[28][14] = -1.000000000000000e+00f;
		pk_A[29][1] = +1.000000000000000e+00f;
		pk_A[29][2] = +1.000000000000000e+00f;
		pk_A[29][3] = +1.000000000000000e+00f;
		pk_A[29][4] = +1.000000000000000e+00f;
		pk_A[29][5] = +1.000000000000000e+00f;
		pk_A[29][6] = +1.000000000000000e+00f;
		pk_A[29][7] = +1.000000000000000e+00f;
		pk_A[29][8] = +1.000000000000000e+00f;
		pk_A[29][9] = +1.000000000000000e+00f;
		pk_A[29][10] = +1.000000000000000e+00f;
		pk_A[29][11] = +1.000000000000000e+00f;
		pk_A[29][12] = +1.000000000000000e+00f;
		pk_A[29][13] = +1.000000000000000e+00f;
		pk_A[29][14] = +1.000000000000000e+00f;
		pk_A[29][15] = +1.000000000000000e+00f;
		pk_A[30][1] = -1.000000000000000e+00f;
		pk_A[30][2] = -1.000000000000000e+00f;
		pk_A[30][3] = -1.000000000000000e+00f;
		pk_A[30][4] = -1.000000000000000e+00f;
		pk_A[30][5] = -1.000000000000000e+00f;
		pk_A[30][6] = -1.000000000000000e+00f;
		pk_A[30][7] = -1.000000000000000e+00f;
		pk_A[30][8] = -1.000000000000000e+00f;
		pk_A[30][9] = -1.000000000000000e+00f;
		pk_A[30][10] = -1.000000000000000e+00f;
		pk_A[30][11] = -1.000000000000000e+00f;
		pk_A[30][12] = -1.000000000000000e+00f;
		pk_A[30][13] = -1.000000000000000e+00f;
		pk_A[30][14] = -1.000000000000000e+00f;
		pk_A[30][15] = -1.000000000000000e+00f;
		pk_A[31][1] = +1.000000000000000e+00f;
		pk_A[31][2] = +1.000000000000000e+00f;
		pk_A[31][3] = +1.000000000000000e+00f;
		pk_A[31][4] = +1.000000000000000e+00f;
		pk_A[31][5] = +1.000000000000000e+00f;
		pk_A[31][6] = +1.000000000000000e+00f;
		pk_A[31][7] = +1.000000000000000e+00f;
		pk_A[31][8] = +1.000000000000000e+00f;
		pk_A[31][9] = +1.000000000000000e+00f;
		pk_A[31][10] = +1.000000000000000e+00f;
		pk_A[31][11] = +1.000000000000000e+00f;
		pk_A[31][12] = +1.000000000000000e+00f;
		pk_A[31][13] = +1.000000000000000e+00f;
		pk_A[31][14] = +1.000000000000000e+00f;
		pk_A[31][15] = +1.000000000000000e+00f;
		pk_A[31][16] = +1.000000000000000e+00f;
		pk_A[32][1] = -1.000000000000000e+00f;
		pk_A[32][2] = -1.000000000000000e+00f;
		pk_A[32][3] = -1.000000000000000e+00f;
		pk_A[32][4] = -1.000000000000000e+00f;
		pk_A[32][5] = -1.000000000000000e+00f;
		pk_A[32][6] = -1.000000000000000e+00f;
		pk_A[32][7] = -1.000000000000000e+00f;
		pk_A[32][8] = -1.000000000000000e+00f;
		pk_A[32][9] = -1.000000000000000e+00f;
		pk_A[32][10] = -1.000000000000000e+00f;
		pk_A[32][11] = -1.000000000000000e+00f;
		pk_A[32][12] = -1.000000000000000e+00f;
		pk_A[32][13] = -1.000000000000000e+00f;
		pk_A[32][14] = -1.000000000000000e+00f;
		pk_A[32][15] = -1.000000000000000e+00f;
		pk_A[32][16] = -1.000000000000000e+00f;
		pk_A[33][1] = +1.000000000000000e+00f;
		pk_A[33][2] = +1.000000000000000e+00f;
		pk_A[33][3] = +1.000000000000000e+00f;
		pk_A[33][4] = +1.000000000000000e+00f;
		pk_A[33][5] = +1.000000000000000e+00f;
		pk_A[33][6] = +1.000000000000000e+00f;
		pk_A[33][7] = +1.000000000000000e+00f;
		pk_A[33][8] = +1.000000000000000e+00f;
		pk_A[33][9] = +1.000000000000000e+00f;
		pk_A[33][10] = +1.000000000000000e+00f;
		pk_A[33][11] = +1.000000000000000e+00f;
		pk_A[33][12] = +1.000000000000000e+00f;
		pk_A[33][13] = +1.000000000000000e+00f;
		pk_A[33][14] = +1.000000000000000e+00f;
		pk_A[33][15] = +1.000000000000000e+00f;
		pk_A[33][16] = +1.000000000000000e+00f;
		pk_A[33][17] = +1.000000000000000e+00f;
		pk_A[34][1] = -1.000000000000000e+00f;
		pk_A[34][2] = -1.000000000000000e+00f;
		pk_A[34][3] = -1.000000000000000e+00f;
		pk_A[34][4] = -1.000000000000000e+00f;
		pk_A[34][5] = -1.000000000000000e+00f;
		pk_A[34][6] = -1.000000000000000e+00f;
		pk_A[34][7] = -1.000000000000000e+00f;
		pk_A[34][8] = -1.000000000000000e+00f;
		pk_A[34][9] = -1.000000000000000e+00f;
		pk_A[34][10] = -1.000000000000000e+00f;
		pk_A[34][11] = -1.000000000000000e+00f;
		pk_A[34][12] = -1.000000000000000e+00f;
		pk_A[34][13] = -1.000000000000000e+00f;
		pk_A[34][14] = -1.000000000000000e+00f;
		pk_A[34][15] = -1.000000000000000e+00f;
		pk_A[34][16] = -1.000000000000000e+00f;
		pk_A[34][17] = -1.000000000000000e+00f;
		pk_A[35][1] = +1.000000000000000e+00f;
		pk_A[35][2] = +1.000000000000000e+00f;
		pk_A[35][3] = +1.000000000000000e+00f;
		pk_A[35][4] = +1.000000000000000e+00f;
		pk_A[35][5] = +1.000000000000000e+00f;
		pk_A[35][6] = +1.000000000000000e+00f;
		pk_A[35][7] = +1.000000000000000e+00f;
		pk_A[35][8] = +1.000000000000000e+00f;
		pk_A[35][9] = +1.000000000000000e+00f;
		pk_A[35][10] = +1.000000000000000e+00f;
		pk_A[35][11] = +1.000000000000000e+00f;
		pk_A[35][12] = +1.000000000000000e+00f;
		pk_A[35][13] = +1.000000000000000e+00f;
		pk_A[35][14] = +1.000000000000000e+00f;
		pk_A[35][15] = +1.000000000000000e+00f;
		pk_A[35][16] = +1.000000000000000e+00f;
		pk_A[35][17] = +1.000000000000000e+00f;
		pk_A[35][18] = +1.000000000000000e+00f;
		pk_A[36][1] = -1.000000000000000e+00f;
		pk_A[36][2] = -1.000000000000000e+00f;
		pk_A[36][3] = -1.000000000000000e+00f;
		pk_A[36][4] = -1.000000000000000e+00f;
		pk_A[36][5] = -1.000000000000000e+00f;
		pk_A[36][6] = -1.000000000000000e+00f;
		pk_A[36][7] = -1.000000000000000e+00f;
		pk_A[36][8] = -1.000000000000000e+00f;
		pk_A[36][9] = -1.000000000000000e+00f;
		pk_A[36][10] = -1.000000000000000e+00f;
		pk_A[36][11] = -1.000000000000000e+00f;
		pk_A[36][12] = -1.000000000000000e+00f;
		pk_A[36][13] = -1.000000000000000e+00f;
		pk_A[36][14] = -1.000000000000000e+00f;
		pk_A[36][15] = -1.000000000000000e+00f;
		pk_A[36][16] = -1.000000000000000e+00f;
		pk_A[36][17] = -1.000000000000000e+00f;
		pk_A[36][18] = -1.000000000000000e+00f;
		pk_A[37][1] = +1.000000000000000e+00f;
		pk_A[37][2] = +1.000000000000000e+00f;
		pk_A[37][3] = +1.000000000000000e+00f;
		pk_A[37][4] = +1.000000000000000e+00f;
		pk_A[37][5] = +1.000000000000000e+00f;
		pk_A[37][6] = +1.000000000000000e+00f;
		pk_A[37][7] = +1.000000000000000e+00f;
		pk_A[37][8] = +1.000000000000000e+00f;
		pk_A[37][9] = +1.000000000000000e+00f;
		pk_A[37][10] = +1.000000000000000e+00f;
		pk_A[37][11] = +1.000000000000000e+00f;
		pk_A[37][12] = +1.000000000000000e+00f;
		pk_A[37][13] = +1.000000000000000e+00f;
		pk_A[37][14] = +1.000000000000000e+00f;
		pk_A[37][15] = +1.000000000000000e+00f;
		pk_A[37][16] = +1.000000000000000e+00f;
		pk_A[37][17] = +1.000000000000000e+00f;
		pk_A[37][18] = +1.000000000000000e+00f;
		pk_A[37][19] = +1.000000000000000e+00f;
		pk_A[38][1] = -1.000000000000000e+00f;
		pk_A[38][2] = -1.000000000000000e+00f;
		pk_A[38][3] = -1.000000000000000e+00f;
		pk_A[38][4] = -1.000000000000000e+00f;
		pk_A[38][5] = -1.000000000000000e+00f;
		pk_A[38][6] = -1.000000000000000e+00f;
		pk_A[38][7] = -1.000000000000000e+00f;
		pk_A[38][8] = -1.000000000000000e+00f;
		pk_A[38][9] = -1.000000000000000e+00f;
		pk_A[38][10] = -1.000000000000000e+00f;
		pk_A[38][11] = -1.000000000000000e+00f;
		pk_A[38][12] = -1.000000000000000e+00f;
		pk_A[38][13] = -1.000000000000000e+00f;
		pk_A[38][14] = -1.000000000000000e+00f;
		pk_A[38][15] = -1.000000000000000e+00f;
		pk_A[38][16] = -1.000000000000000e+00f;
		pk_A[38][17] = -1.000000000000000e+00f;
		pk_A[38][18] = -1.000000000000000e+00f;
		pk_A[38][19] = -1.000000000000000e+00f;
		pk_A[39][1] = +1.000000000000000e+00f;
		pk_A[39][2] = +1.000000000000000e+00f;
		pk_A[39][3] = +1.000000000000000e+00f;
		pk_A[39][4] = +1.000000000000000e+00f;
		pk_A[39][5] = +1.000000000000000e+00f;
		pk_A[39][6] = +1.000000000000000e+00f;
		pk_A[39][7] = +1.000000000000000e+00f;
		pk_A[39][8] = +1.000000000000000e+00f;
		pk_A[39][9] = +1.000000000000000e+00f;
		pk_A[39][10] = +1.000000000000000e+00f;
		pk_A[39][11] = +1.000000000000000e+00f;
		pk_A[39][12] = +1.000000000000000e+00f;
		pk_A[39][13] = +1.000000000000000e+00f;
		pk_A[39][14] = +1.000000000000000e+00f;
		pk_A[39][15] = +1.000000000000000e+00f;
		pk_A[39][16] = +1.000000000000000e+00f;
		pk_A[39][17] = +1.000000000000000e+00f;
		pk_A[39][18] = +1.000000000000000e+00f;
		pk_A[39][19] = +1.000000000000000e+00f;
		pk_A[39][20] = +1.000000000000000e+00f;
		pk_A[40][1] = -1.000000000000000e+00f;
		pk_A[40][2] = -1.000000000000000e+00f;
		pk_A[40][3] = -1.000000000000000e+00f;
		pk_A[40][4] = -1.000000000000000e+00f;
		pk_A[40][5] = -1.000000000000000e+00f;
		pk_A[40][6] = -1.000000000000000e+00f;
		pk_A[40][7] = -1.000000000000000e+00f;
		pk_A[40][8] = -1.000000000000000e+00f;
		pk_A[40][9] = -1.000000000000000e+00f;
		pk_A[40][10] = -1.000000000000000e+00f;
		pk_A[40][11] = -1.000000000000000e+00f;
		pk_A[40][12] = -1.000000000000000e+00f;
		pk_A[40][13] = -1.000000000000000e+00f;
		pk_A[40][14] = -1.000000000000000e+00f;
		pk_A[40][15] = -1.000000000000000e+00f;
		pk_A[40][16] = -1.000000000000000e+00f;
		pk_A[40][17] = -1.000000000000000e+00f;
		pk_A[40][18] = -1.000000000000000e+00f;
		pk_A[40][19] = -1.000000000000000e+00f;
		pk_A[40][20] = -1.000000000000000e+00f;
		pk_A[41][1] = +1.000000000000000e+00f;
		pk_A[42][1] = -1.000000000000000e+00f;
		pk_A[43][2] = +1.000000000000000e+00f;
		pk_A[44][2] = -1.000000000000000e+00f;
		pk_A[45][3] = +1.000000000000000e+00f;
		pk_A[46][3] = -1.000000000000000e+00f;
		pk_A[47][4] = +1.000000000000000e+00f;
		pk_A[48][4] = -1.000000000000000e+00f;
		pk_A[49][5] = +1.000000000000000e+00f;
		pk_A[50][5] = -1.000000000000000e+00f;
		pk_A[51][6] = +1.000000000000000e+00f;
		pk_A[52][6] = -1.000000000000000e+00f;
		pk_A[53][7] = +1.000000000000000e+00f;
		pk_A[54][7] = -1.000000000000000e+00f;
		pk_A[55][8] = +1.000000000000000e+00f;
		pk_A[56][8] = -1.000000000000000e+00f;
		pk_A[57][9] = +1.000000000000000e+00f;
		pk_A[58][9] = -1.000000000000000e+00f;
		pk_A[59][10] = +1.000000000000000e+00f;
		pk_A[60][10] = -1.000000000000000e+00f;
		pk_A[61][11] = +1.000000000000000e+00f;
		pk_A[62][11] = -1.000000000000000e+00f;
		pk_A[63][12] = +1.000000000000000e+00f;
		pk_A[64][12] = -1.000000000000000e+00f;
		pk_A[65][13] = +1.000000000000000e+00f;
		pk_A[66][13] = -1.000000000000000e+00f;
		pk_A[67][14] = +1.000000000000000e+00f;
		pk_A[68][14] = -1.000000000000000e+00f;
		pk_A[69][15] = +1.000000000000000e+00f;
		pk_A[70][15] = -1.000000000000000e+00f;
		pk_A[71][16] = +1.000000000000000e+00f;
		pk_A[72][16] = -1.000000000000000e+00f;
		pk_A[73][17] = +1.000000000000000e+00f;
		pk_A[74][17] = -1.000000000000000e+00f;
		pk_A[75][18] = +1.000000000000000e+00f;
		pk_A[76][18] = -1.000000000000000e+00f;
		pk_A[77][19] = +1.000000000000000e+00f;
		pk_A[78][19] = -1.000000000000000e+00f;
		pk_A[79][20] = +1.000000000000000e+00f;
		pk_A[80][20] = -1.000000000000000e+00f;

		for(i=1;i<=80;++i)
			pk_b[i] = 0.0f;
		pk_b[41] = -1.000000000000000e-01f;
		pk_b[42] = -1.000000000000000e-01f;
		pk_b[43] = -1.000000000000000e-01f;
		pk_b[44] = -1.000000000000000e-01f;
		pk_b[45] = -1.000000000000000e-01f;
		pk_b[46] = -1.000000000000000e-01f;
		pk_b[47] = -1.000000000000000e-01f;
		pk_b[48] = -1.000000000000000e-01f;
		pk_b[49] = -1.000000000000000e-01f;
		pk_b[50] = -1.000000000000000e-01f;
		pk_b[51] = -1.000000000000000e-01f;
		pk_b[52] = -1.000000000000000e-01f;
		pk_b[53] = -1.000000000000000e-01f;
		pk_b[54] = -1.000000000000000e-01f;
		pk_b[55] = -1.000000000000000e-01f;
		pk_b[56] = -1.000000000000000e-01f;
		pk_b[57] = -1.000000000000000e-01f;
		pk_b[58] = -1.000000000000000e-01f;
		pk_b[59] = -1.000000000000000e-01f;
		pk_b[60] = -1.000000000000000e-01f;
		pk_b[61] = -1.000000000000000e-01f;
		pk_b[62] = -1.000000000000000e-01f;
		pk_b[63] = -1.000000000000000e-01f;
		pk_b[64] = -1.000000000000000e-01f;
		pk_b[65] = -1.000000000000000e-01f;
		pk_b[66] = -1.000000000000000e-01f;
		pk_b[67] = -1.000000000000000e-01f;
		pk_b[68] = -1.000000000000000e-01f;
		pk_b[69] = -1.000000000000000e-01f;
		pk_b[70] = -1.000000000000000e-01f;
		pk_b[71] = -1.000000000000000e-01f;
		pk_b[72] = -1.000000000000000e-01f;
		pk_b[73] = -1.000000000000000e-01f;
		pk_b[74] = -1.000000000000000e-01f;
		pk_b[75] = -1.000000000000000e-01f;
		pk_b[76] = -1.000000000000000e-01f;
		pk_b[77] = -1.000000000000000e-01f;
		pk_b[78] = -1.000000000000000e-01f;
		pk_b[79] = -1.000000000000000e-01f;
		pk_b[80] = -1.000000000000000e-01f;

		pk_G[1][1] = +3.550638944072177e+01f;
		pk_G[1][2] = +3.232141896315725e+01f;
		pk_G[1][3] = +3.082296183117234e+01f;
		pk_G[1][4] = +2.915280243859023e+01f;
		pk_G[1][5] = +2.738866981235969e+01f;
		pk_G[1][6] = +2.557313554236218e+01f;
		pk_G[1][7] = +2.372954051559045e+01f;
		pk_G[1][8] = +2.187072735354979e+01f;
		pk_G[1][9] = +2.000384517398167e+01f;
		pk_G[1][10] = +1.813302426342056e+01f;
		pk_G[1][11] = +1.626092132577483e+01f;
		pk_G[1][12] = +1.438971342497714e+01f;
		pk_G[1][13] = +1.252191248173283e+01f;
		pk_G[1][14] = +1.066130504897456e+01f;
		pk_G[1][15] = +8.814368960682470e+00f;
		pk_G[1][16] = +6.992696859569787e+00f;
		pk_G[1][17] = +5.217333308940035e+00f;
		pk_G[1][18] = +3.526648116072352e+00f;
		pk_G[1][19] = +1.990691481642366e+00f;
		pk_G[1][20] = +7.374005634681263e-01f;
		pk_G[2][1] = +3.232141896315725e+01f;
		pk_G[2][2] = +3.362849180140925e+01f;
		pk_G[2][3] = +3.044353139314530e+01f;
		pk_G[2][4] = +2.894509265462200e+01f;
		pk_G[2][5] = +2.727496686113922e+01f;
		pk_G[2][6] = +2.551089560995051e+01f;
		pk_G[2][7] = +2.369547345295111e+01f;
		pk_G[2][8] = +2.185208322154845e+01f;
		pk_G[2][9] = +1.999364415656971e+01f;
		pk_G[2][10] = +1.812744533528441e+01f;
		pk_G[2][11] = +1.625787270649356e+01f;
		pk_G[2][12] = +1.438804998907365e+01f;
		pk_G[2][13] = +1.252100733718214e+01f;
		pk_G[2][14] = +1.066081500044612e+01f;
		pk_G[2][15] = +8.814106111160768e+00f;
		pk_G[2][16] = +6.992558313149942e+00f;
		pk_G[2][17] = +5.217262674769586e+00f;
		pk_G[2][18] = +3.526614411053513e+00f;
		pk_G[2][19] = +1.990677538842087e+00f;
		pk_G[2][20] = +7.373966095210316e-01f;
		pk_G[3][1] = +3.082296183117234e+01f;
		pk_G[3][2] = +3.044353139314530e+01f;
		pk_G[3][3] = +3.175061430064388e+01f;
		pk_G[3][4] = +2.856567228574292e+01f;
		pk_G[3][5] = +2.706726714613879e+01f;
		pk_G[3][6] = +2.539720272736875e+01f;
		pk_G[3][7] = +2.363324358857699e+01f;
		pk_G[3][8] = +2.181802622584854e+01f;
		pk_G[3][9] = +1.997501008950189e+01f;
		pk_G[3][10] = +1.811725437914180e+01f;
		pk_G[3][11] = +1.625230383293348e+01f;
		pk_G[3][12] = +1.438501141214188e+01f;
		pk_G[3][13] = +1.251935392129406e+01f;
		pk_G[3][14] = +1.065991983511344e+01f;
		pk_G[3][15] = +8.813625967326251e+00f;
		pk_G[3][16] = +6.992305232189961e+00f;
		pk_G[3][17] = +5.217133648240536e+00f;
		pk_G[3][18] = +3.526552842529885e+00f;
		pk_G[3][19] = +1.990652069708468e+00f;
		pk_G[3][20] = +7.373893868968195e-01f;
		pk_G[4][1] = +2.915280243859023e+01f;
		pk_G[4][2] = +2.894509265462200e+01f;
		pk_G[4][3] = +2.856567228574292e+01f;
		pk_G[4][4] = +2.987277358642433e+01f;
		pk_G[4][5] = +2.668786517011344e+01f;
		pk_G[4][6] = +2.518952140462091e+01f;
		pk_G[4][7] = +2.351956909714970e+01f;
		pk_G[4][8] = +2.175581475062298e+01f;
		pk_G[4][9] = +1.994097147928637e+01f;
		pk_G[4][10] = +1.809863869086508e+01f;
		pk_G[4][11] = +1.624213124335540e+01f;
		pk_G[4][12] = +1.437946088281223e+01f;
		pk_G[4][13] = +1.251633364779532e+01f;
		pk_G[4][14] = +1.065828464813431e+01f;
		pk_G[4][15] = +8.812748894770323e+00f;
		pk_G[4][16] = +6.991842932461272e+00f;
		pk_G[4][17] = +5.216897957142407e+00f;
		pk_G[4][18] = +3.526440376101074e+00f;
		pk_G[4][19] = +1.990605545570252e+00f;
		pk_G[4][20] = +7.373761934222338e-01f;
		pk_G[5][1] = +2.738866981235969e+01f;
		pk_G[5][2] = +2.727496686113922e+01f;
		pk_G[5][3] = +2.706726714613879e+01f;
		pk_G[5][4] = +2.668786517011344e+01f;
		pk_G[5][5] = +2.799500006878379e+01f;
		pk_G[5][6] = +2.481015302548637e+01f;
		pk_G[5][7] = +2.331192136928675e+01f;
		pk_G[5][8] = +2.164217385041642e+01f;
		pk_G[5][9] = +1.987879358858824e+01f;
		pk_G[5][10] = +1.806463365295044e+01f;
		pk_G[5][11] = +1.622354910504546e+01f;
		pk_G[5][12] = +1.436932180240354e+01f;
		pk_G[5][13] = +1.251081655311097e+01f;
		pk_G[5][14] = +1.065529767314867e+01f;
		pk_G[5][15] = +8.811146757633361e+00f;
		pk_G[5][16] = +6.990998455503542e+00f;
		pk_G[5][17] = +5.216467423250303e+00f;
		pk_G[5][18] = +3.526234935124679e+00f;
		pk_G[5][19] = +1.990520560526429e+00f;
		pk_G[5][20] = +7.373520930722041e-01f;
		pk_G[6][1] = +2.557313554236218e+01f;
		pk_G[6][2] = +2.551089560995051e+01f;
		pk_G[6][3] = +2.539720272736875e+01f;
		pk_G[6][4] = +2.518952140462091e+01f;
		pk_G[6][5] = +2.481015302548637e+01f;
		pk_G[6][6] = +2.611734929516427e+01f;
		pk_G[6][7] = +2.293261435749561e+01f;
		pk_G[6][8] = +2.143458748320357e+01f;
		pk_G[6][9] = +1.976521403680522e+01f;
		pk_G[6][10] = +1.800251708834174e+01f;
		pk_G[6][11] = +1.618960535242286e+01f;
		pk_G[6][12] = +1.435080087486155e+01f;
		pk_G[6][13] = +1.250073854733802e+01f;
		pk_G[6][14] = +1.064984140442915e+01f;
		pk_G[6][15] = +8.808220154368579e+00f;
		pk_G[6][16] = +6.989455860325820e+00f;
		pk_G[6][17] = +5.215680972536962e+00f;
		pk_G[6][18] = +3.525859658740176e+00f;
		pk_G[6][19] = +1.990365319441898e+00f;
		pk_G[6][20] = +7.373080692733344e-01f;
		pk_G[7][1] = +2.372954051559045e+01f;
		pk_G[7][2] = +2.369547345295111e+01f;
		pk_G[7][3] = +2.363324358857699e+01f;
		pk_G[7][4] = +2.351956909714970e+01f;
		pk_G[7][5] = +2.331192136928675e+01f;
		pk_G[7][6] = +2.293261435749561e+01f;
		pk_G[7][7] = +2.423992272610897e+01f;
		pk_G[7][8] = +2.105539255812132e+01f;
		pk_G[7][9] = +1.955773973396717e+01f;
		pk_G[7][10] = +1.788904956013612e+01f;
		pk_G[7][11] = +1.612760073686748e+01f;
		pk_G[7][12] = +1.431696893516006e+01f;
		pk_G[7][13] = +1.248232918404623e+01f;
		pk_G[7][14] = +1.063987450866242e+01f;
		pk_G[7][15] = +8.802874165893659e+00f;
		pk_G[7][16] = +6.986638021590792e+00f;
		pk_G[7][17] = +5.214244373152207e+00f;
		pk_G[7][18] = +3.525174146203986e+00f;
		pk_G[7][19] = +1.990081742553044e+00f;
		pk_G[7][20] = +7.372276515671791e-01f;
		pk_G[8][1] = +2.187072735354979e+01f;
		pk_G[8][2] = +2.185208322154845e+01f;
		pk_G[8][3] = +2.181802622584854e+01f;
		pk_G[8][4] = +2.175581475062298e+01f;
		pk_G[8][5] = +2.164217385041642e+01f;
		pk_G[8][6] = +2.143458748320357e+01f;
		pk_G[8][7] = +2.105539255812132e+01f;
		pk_G[8][8] = +2.236290567408160e+01f;
		pk_G[8][9] = +1.917874951543444e+01f;
		pk_G[8][10] = +1.768177988932351e+01f;
		pk_G[8][11] = +1.601433770455509e+01f;
		pk_G[8][12] = +1.425516856682700e+01f;
		pk_G[8][13] = +1.244870103732308e+01f;
		pk_G[8][14] = +1.062166810858735e+01f;
		pk_G[8][15] = +8.793108717628808e+00f;
		pk_G[8][16] = +6.981490711880958e+00f;
		pk_G[8][17] = +5.211620155566448e+00f;
		pk_G[8][18] = +3.523921929286856e+00f;
		pk_G[8][19] = +1.989563736304023e+00f;
		pk_G[8][20] = +7.370807535795160e-01f;
		pk_G[9][1] = +2.000384517398167e+01f;
		pk_G[9][2] = +1.999364415656971e+01f;
		pk_G[9][3] = +1.997501008950189e+01f;
		pk_G[9][4] = +1.994097147928637e+01f;
		pk_G[9][5] = +1.987879358858824e+01f;
		pk_G[9][6] = +1.976521403680522e+01f;
		pk_G[9][7] = +1.955773973396717e+01f;
		pk_G[9][8] = +1.917874951543444e+01f;
		pk_G[9][9] = +2.048663656621113e+01f;
		pk_G[9][10] = +1.730316346947499e+01f;
		pk_G[9][11] = +1.580744158375576e+01f;
		pk_G[9][12] = +1.414227863028392e+01f;
		pk_G[9][13] = +1.238727293499771e+01f;
		pk_G[9][14] = +1.058841071215704e+01f;
		pk_G[9][15] = +8.775270299109788e+00f;
		pk_G[9][16] = +6.972088187556342e+00f;
		pk_G[9][17] = +5.206826531115205e+00f;
		pk_G[9][18] = +3.521634520778968e+00f;
		pk_G[9][19] = +1.988617500963370e+00f;
		pk_G[9][20] = +7.368124169182109e-01f;
		pk_G[10][1] = +1.813302426342056e+01f;
		pk_G[10][2] = +1.812744533528441e+01f;
		pk_G[10][3] = +1.811725437914180e+01f;
		pk_G[10][4] = +1.809863869086508e+01f;
		pk_G[10][5] = +1.806463365295044e+01f;
		pk_G[10][6] = +1.800251708834174e+01f;
		pk_G[10][7] = +1.788904956013612e+01f;
		pk_G[10][8] = +1.768177988932351e+01f;
		pk_G[10][9] = +1.730316346947499e+01f;
		pk_G[10][10] = +1.861173333349177e+01f;
		pk_G[10][11] = +1.542950752290336e+01f;
		pk_G[10][12] = +1.393606403871909e+01f;
		pk_G[10][13] = +1.227506301197429e+01f;
		pk_G[10][14] = +1.052765985461454e+01f;
		pk_G[10][15] = +8.742685089846534e+00f;
		pk_G[10][16] = +6.954912717522729e+00f;
		pk_G[10][17] = +5.198070079095275e+00f;
		pk_G[10][18] = +3.517456141130537e+00f;
		pk_G[10][19] = +1.986889025058705e+00f;
		pk_G[10][20] = +7.363222497964840e-01f;
		pk_G[11][1] = +1.626092132577483e+01f;
		pk_G[11][2] = +1.625787270649356e+01f;
		pk_G[11][3] = +1.625230383293348e+01f;
		pk_G[11][4] = +1.624213124335540e+01f;
		pk_G[11][5] = +1.622354910504546e+01f;
		pk_G[11][6] = +1.618960535242286e+01f;
		pk_G[11][7] = +1.612760073686748e+01f;
		pk_G[11][8] = +1.601433770455509e+01f;
		pk_G[11][9] = +1.580744158375576e+01f;
		pk_G[11][10] = +1.542950752290336e+01f;
		pk_G[11][11] = +1.673932384330625e+01f;
		pk_G[11][12] = +1.355937491853795e+01f;
		pk_G[11][13] = +1.207009059234394e+01f;
		pk_G[11][14] = +1.041668704590978e+01f;
		pk_G[11][15] = +8.683162107941042e+00f;
		pk_G[11][16] = +6.923538507715771e+00f;
		pk_G[11][17] = +5.182074781016083e+00f;
		pk_G[11][18] = +3.509823548864564e+00f;
		pk_G[11][19] = +1.983731640394814e+00f;
		pk_G[11][20] = +7.354268678309577e-01f;
		pk_G[12][1] = +1.438971342497714e+01f;
		pk_G[12][2] = +1.438804998907365e+01f;
		pk_G[12][3] = +1.438501141214188e+01f;
		pk_G[12][4] = +1.437946088281223e+01f;
		pk_G[12][5] = +1.436932180240354e+01f;
		pk_G[12][6] = +1.435080087486155e+01f;
		pk_G[12][7] = +1.431696893516006e+01f;
		pk_G[12][8] = +1.425516856682700e+01f;
		pk_G[12][9] = +1.414227863028392e+01f;
		pk_G[12][10] = +1.393606403871909e+01f;
		pk_G[12][11] = +1.355937491853795e+01f;
		pk_G[12][12] = +1.487146535602417e+01f;
		pk_G[12][13] = +1.169567053163030e+01f;
		pk_G[12][14] = +1.021397444706529e+01f;
		pk_G[12][15] = +8.574432243841423e+00f;
		pk_G[12][16] = +6.866227642913544e+00f;
		pk_G[12][17] = +5.152856376111920e+00f;
		pk_G[12][18] = +3.495881190917153e+00f;
		pk_G[12][19] = +1.977964086511728e+00f;
		pk_G[12][20] = +7.337912851313972e-01f;
		pk_G[13][1] = +1.252191248173283e+01f;
		pk_G[13][2] = +1.252100733718214e+01f;
		pk_G[13][3] = +1.251935392129406e+01f;
		pk_G[13][4] = +1.251633364779532e+01f;
		pk_G[13][5] = +1.251081655311097e+01f;
		pk_G[13][6] = +1.250073854733802e+01f;
		pk_G[13][7] = +1.248232918404623e+01f;
		pk_G[13][8] = +1.244870103732308e+01f;
		pk_G[13][9] = +1.238727293499771e+01f;
		pk_G[13][10] = +1.227506301197429e+01f;
		pk_G[13][11] = +1.207009059234394e+01f;
		pk_G[13][12] = +1.169567053163030e+01f;
		pk_G[13][13] = +1.301190583080931e+01f;
		pk_G[13][14] = +9.843682371863721e+00f;
		pk_G[13][15] = +8.375816803007128e+00f;
		pk_G[13][16] = +6.761538624623650e+00f;
		pk_G[13][17] = +5.099483492348398e+00f;
		pk_G[13][18] = +3.470412865299880e+00f;
		pk_G[13][19] = +1.967428570147590e+00f;
		pk_G[13][20] = +7.308035872883563e-01f;
		pk_G[14][1] = +1.066130504897456e+01f;
		pk_G[14][2] = +1.066081500044612e+01f;
		pk_G[14][3] = +1.065991983511344e+01f;
		pk_G[14][4] = +1.065828464813431e+01f;
		pk_G[14][5] = +1.065529767314867e+01f;
		pk_G[14][6] = +1.064984140442915e+01f;
		pk_G[14][7] = +1.063987450866242e+01f;
		pk_G[14][8] = +1.062166810858735e+01f;
		pk_G[14][9] = +1.058841071215704e+01f;
		pk_G[14][10] = +1.052765985461454e+01f;
		pk_G[14][11] = +1.041668704590978e+01f;
		pk_G[14][12] = +1.021397444706529e+01f;
		pk_G[14][13] = +9.843682371863721e+00f;
		pk_G[14][14] = +1.116745820898913e+01f;
		pk_G[14][15] = +8.013008953551495e+00f;
		pk_G[14][16] = +6.570304544764267e+00f;
		pk_G[14][17] = +5.001987933281590e+00f;
		pk_G[14][18] = +3.423890203050493e+00f;
		pk_G[14][19] = +1.948183478153821e+00f;
		pk_G[14][20] = +7.253459981345266e-01f;
		pk_G[15][1] = +8.814368960682470e+00f;
		pk_G[15][2] = +8.814106111160768e+00f;
		pk_G[15][3] = +8.813625967326251e+00f;
		pk_G[15][4] = +8.812748894770323e+00f;
		pk_G[15][5] = +8.811146757633361e+00f;
		pk_G[15][6] = +8.808220154368579e+00f;
		pk_G[15][7] = +8.802874165893659e+00f;
		pk_G[15][8] = +8.793108717628808e+00f;
		pk_G[15][9] = +8.775270299109788e+00f;
		pk_G[15][10] = +8.742685089846534e+00f;
		pk_G[15][11] = +8.683162107941042e+00f;
		pk_G[15][12] = +8.574432243841423e+00f;
		pk_G[15][13] = +8.375816803007128e+00f;
		pk_G[15][14] = +8.013008953551495e+00f;
		pk_G[15][15] = +9.350456129413836e+00f;
		pk_G[15][16] = +6.220980132293740e+00f;
		pk_G[15][17] = +4.823894052698339e+00f;
		pk_G[15][18] = +3.338907855359445e+00f;
		pk_G[15][19] = +1.913028716579024e+00f;
		pk_G[15][20] = +7.153766903474707e-01f;
		pk_G[16][1] = +6.992696859569787e+00f;
		pk_G[16][2] = +6.992558313149942e+00f;
		pk_G[16][3] = +6.992305232189961e+00f;
		pk_G[16][4] = +6.991842932461272e+00f;
		pk_G[16][5] = +6.990998455503542e+00f;
		pk_G[16][6] = +6.989455860325820e+00f;
		pk_G[16][7] = +6.986638021590792e+00f;
		pk_G[16][8] = +6.981490711880958e+00f;
		pk_G[16][9] = +6.972088187556342e+00f;
		pk_G[16][10] = +6.954912717522729e+00f;
		pk_G[16][11] = +6.923538507715771e+00f;
		pk_G[16][12] = +6.866227642913544e+00f;
		pk_G[16][13] = +6.761538624623650e+00f;
		pk_G[16][14] = +6.570304544764267e+00f;
		pk_G[16][15] = +6.220980132293740e+00f;
		pk_G[16][16] = +7.583057328764648e+00f;
		pk_G[16][17] = +4.498572672935963e+00f;
		pk_G[16][18] = +3.183671696765377e+00f;
		pk_G[16][19] = +1.848811966576501e+00f;
		pk_G[16][20] = +6.971658842659448e-01f;
		pk_G[17][1] = +5.217333308940035e+00f;
		pk_G[17][2] = +5.217262674769586e+00f;
		pk_G[17][3] = +5.217133648240536e+00f;
		pk_G[17][4] = +5.216897957142407e+00f;
		pk_G[17][5] = +5.216467423250303e+00f;
		pk_G[17][6] = +5.215680972536962e+00f;
		pk_G[17][7] = +5.214244373152207e+00f;
		pk_G[17][8] = +5.211620155566448e+00f;
		pk_G[17][9] = +5.206826531115205e+00f;
		pk_G[17][10] = +5.198070079095275e+00f;
		pk_G[17][11] = +5.182074781016083e+00f;
		pk_G[17][12] = +5.152856376111920e+00f;
		pk_G[17][13] = +5.099483492348398e+00f;
		pk_G[17][14] = +5.001987933281590e+00f;
		pk_G[17][15] = +4.823894052698339e+00f;
		pk_G[17][16] = +4.498572672935963e+00f;
		pk_G[17][17] = +5.904495899979243e+00f;
		pk_G[17][18] = +2.900104223242203e+00f;
		pk_G[17][19] = +1.731508057718338e+00f;
		pk_G[17][20] = +6.639004394425617e-01f;
		pk_G[18][1] = +3.526648116072352e+00f;
		pk_G[18][2] = +3.526614411053513e+00f;
		pk_G[18][3] = +3.526552842529885e+00f;
		pk_G[18][4] = +3.526440376101074e+00f;
		pk_G[18][5] = +3.526234935124679e+00f;
		pk_G[18][6] = +3.525859658740176e+00f;
		pk_G[18][7] = +3.525174146203986e+00f;
		pk_G[18][8] = +3.523921929286856e+00f;
		pk_G[18][9] = +3.521634520778968e+00f;
		pk_G[18][10] = +3.517456141130537e+00f;
		pk_G[18][11] = +3.509823548864564e+00f;
		pk_G[18][12] = +3.495881190917153e+00f;
		pk_G[18][13] = +3.470412865299880e+00f;
		pk_G[18][14] = +3.423890203050493e+00f;
		pk_G[18][15] = +3.338907855359445e+00f;
		pk_G[18][16] = +3.183671696765377e+00f;
		pk_G[18][17] = +2.900104223242203e+00f;
		pk_G[18][18] = +4.382298772814689e+00f;
		pk_G[18][19] = +1.517230936031737e+00f;
		pk_G[18][20] = +6.031348809484122e-01f;
		pk_G[19][1] = +1.990691481642366e+00f;
		pk_G[19][2] = +1.990677538842087e+00f;
		pk_G[19][3] = +1.990652069708468e+00f;
		pk_G[19][4] = +1.990605545570252e+00f;
		pk_G[19][5] = +1.990520560526429e+00f;
		pk_G[19][6] = +1.990365319441898e+00f;
		pk_G[19][7] = +1.990081742553044e+00f;
		pk_G[19][8] = +1.989563736304023e+00f;
		pk_G[19][9] = +1.988617500963370e+00f;
		pk_G[19][10] = +1.986889025058705e+00f;
		pk_G[19][11] = +1.983731640394814e+00f;
		pk_G[19][12] = +1.977964086511728e+00f;
		pk_G[19][13] = +1.967428570147590e+00f;
		pk_G[19][14] = +1.948183478153821e+00f;
		pk_G[19][15] = +1.913028716579024e+00f;
		pk_G[19][16] = +1.848811966576501e+00f;
		pk_G[19][17] = +1.731508057718338e+00f;
		pk_G[19][18] = +1.517230936031737e+00f;
		pk_G[19][19] = +3.125997276541039e+00f;
		pk_G[19][20] = +4.921356337783773e-01f;
		pk_G[20][1] = +7.374005634681263e-01f;
		pk_G[20][2] = +7.373966095210316e-01f;
		pk_G[20][3] = +7.373893868968195e-01f;
		pk_G[20][4] = +7.373761934222338e-01f;
		pk_G[20][5] = +7.373520930722041e-01f;
		pk_G[20][6] = +7.373080692733344e-01f;
		pk_G[20][7] = +7.372276515671791e-01f;
		pk_G[20][8] = +7.370807535795160e-01f;
		pk_G[20][9] = +7.368124169182109e-01f;
		pk_G[20][10] = +7.363222497964840e-01f;
		pk_G[20][11] = +7.354268678309577e-01f;
		pk_G[20][12] = +7.337912851313972e-01f;
		pk_G[20][13] = +7.308035872883563e-01f;
		pk_G[20][14] = +7.253459981345266e-01f;
		pk_G[20][15] = +7.153766903474707e-01f;
		pk_G[20][16] = +6.971658842659448e-01f;
		pk_G[20][17] = +6.639004394425617e-01f;
		pk_G[20][18] = +6.031348809484122e-01f;
		pk_G[20][19] = +4.921356337783773e-01f;
		pk_G[20][20] = +2.289557630628992e+00f;

		reg_Yzad=dwektor(1,20);
		reg_Y0  =dwektor(1,20);
		reg_wp1 =dwektor(1,20);
		reg_mp1 =dtablica(1,20,1,20);
		reg_gpc_y0 =dtablica(1,1,1,20);
		return;
	}
	for(m=1;m<=1;m++){
		ymod=0.0f;
		for(n=1;n<=1;n++)
			for(i=1;i<=2;i++)
				ymod=ymod+mod_wspb[m][n][i]*ad->u[k-i][n-1];
		for(i=1;i<=2;i++)
			ymod=ymod-mod_wspa[m][i]*ad->y[k-i][m-1];
		ddmc=ad->y[k][m-1]-ymod;
		for(p=1;p<=20;p++){
			reg_gpc_y0[m][p]=ddmc;
			for(n=1;n<=1;n++){
				for(i=1;i<=2;i++){
					if(-i+p>=0)
						liczba=ad->u[k-1][n-1];
					else
						liczba=ad->u[k-i+p][n-1];
					reg_gpc_y0[m][p]=reg_gpc_y0[m][p]+mod_wspb[m][n][i]*liczba;
				}
			}
			for(i=1;i<=2;i++){
				if(-i+p>=1)
					liczba=reg_gpc_y0[m][p-i];
				else
					liczba=ad->y[k+p-i][m-1];
				reg_gpc_y0[m][p]=reg_gpc_y0[m][p]-mod_wspa[m][i]*liczba;
			}
		}
	}
	l=1;
	for(p=1;p<=20;p++){
		for(m=1;m<=1;m++){
			reg_Y0[l++]=reg_gpc_y0[m][p];
		}
	}
	l=1;
	for(p=1;p<=20;p++){
		for(m=0;m<1;m++){
			reg_Yzad[l++] = ad->z[m];
		}
	}

	i=1;
	for(p=0;p<=19;p++){
		for(n=1;n<=1;n++){
			pk_b[i++]=-1.000000000000000e+00f-ad->u[k-1][n-1];
			pk_b[i++]=-1.000000000000000e+00f+ad->u[k-1][n-1];
		}
	}

	sumaww(reg_Yzad,reg_Y0,reg_wp1,20,-1);
	iloczynatb(reg_M,reg_PSI,reg_mp1,20,20,20,20);
	iloczynaw(reg_mp1,reg_wp1,pk_t,20,20,20);
	for(i=1;i<=20;i++) pk_t[i]=-2.0f*pk_t[i];

    for(i=1;i<=20;i++) pk_x[i]=0.0f;
	i=pk();
    for(n=1;n<=1;n++) du[n-1]=pk_x[n];


	setCurrentControlIncrement(c,du);
}

//////////////////////////////////////////////////// TUTAJ ZACZYNA SIE ROBOTA UZYTKOWNIKA KONCOWEGO
ArchiveData ad;
CurrentControl cc;

void measurements(){
    new_output(&ad,measureOutput());
}

void controller_setup(){
    init_archive_data(&ad, 100, 100, 1, 1, 0.0f, 0.0f, 0.0f);
    init_current_control(&cc,&ad);
    get_time();
    CONTROLLER(NULL,NULL);
}

void idle(){
    const int k = 0;
    // Komunikacja z komputerem zbierającym dane 
    // sprintf(str, "y=[%8.4f,%8.4f];z=[%8.4f,%8.4f];u=[%8.4f,%8.4f];\n\r", ad.y[k][0],ad.y[k][1],ad.z[0],ad.z[1],ad.u[k-1][0],ad.u[k-1][1]);
    sprintf(str, "y=%8.4f;z=%8.4f;u=%8.4f;t=%d/108;\n\r", ad.y[k][0],ad.z[0],ad.u[k-1][0],tcur);
    if(i>=0){
        write_string(str);
    }
    if(i>=700){
        sprintf(str, "DONE=1;tmax=%d/108;tmin=%d/108;\n\r", tmax, tmin);
        write_string(str);
    }
    ++i;
    //HAL_Delay(1000);
}

void loop(){
         if(i< 50) ad.z[0] = +0.0;
    else if(i<100) ad.z[0] = +0.1;
    else if(i<150) ad.z[0] = -0.2;
    else if(i<200) ad.z[0] = +0.2;
    else if(i<250) ad.z[0] = -0.3;
    else if(i<300) ad.z[0] = -0.2;
    else if(i<350) ad.z[0] = -0.1;
    else if(i<400) ad.z[0] = +0.0;
    else if(i<450) ad.z[0] = +0.1;
    else if(i<500) ad.z[0] = +0.2;
    else if(i<550) ad.z[0] = +0.3;
    else if(i<600) ad.z[0] = +0.1;
    else if(i<650) ad.z[0] = -0.1;
    else           ad.z[0] = +0.0;
    
    htim5.Instance->CNT = 0; // reset timer counter
    
    CONTROLLER(&ad,&cc);

    tcur = htim5.Instance->CNT;
    tmax = (tcur>tmax)?tcur:tmax;
    tmin = (tcur<tmin)?tcur:tmin;     

}

void controls(){
    pushCurrentControlsToArchiveData(&cc,&ad);
    //projectOnFeasibleSet(&ad, NAN, NAN, 0.0, 1.0);
    setControlValue(last_control(&ad));
}

void timeout(){
    //setControlValue(0.0);
    // while(1);
}

// test1
